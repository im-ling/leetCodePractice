from bisect import bisect_right
class Solution:
    def longestObstacleCourseAtEachPosition(self, obstacles: List[int]) -> List[int]:
        n=len(obstacles)
        ans=[0]*n
        ans[0]=1
        mx=[obstacles[0]]
        for i in range(1,n):
            if mx[-1]<=obstacles[i]:
                mx.append(obstacles[i])
                ans[i]=max(ans[i],len(mx))
            else:
                x=bisect_right(mx,obstacles[i])
                if x<len(mx):
                    mx[x]=obstacles[i]
                    ans[i]=max(ans[i],x+1) if x>0 else 1
        print(mx)
        return ans