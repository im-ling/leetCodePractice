from sortedcontainers.sortedlist import SortedList

class Solution:
    def longestObstacleCourseAtEachPosition(self, obstacles: List[int]) -> List[int]:
        sort = []
        res = []
        for val in obstacles:
            idx = bisect_right(sort, val)
            if idx == len(sort):
                sort.append(val)
            else:
                sort[idx] = val
            res.append(idx + 1)
        return res
        
