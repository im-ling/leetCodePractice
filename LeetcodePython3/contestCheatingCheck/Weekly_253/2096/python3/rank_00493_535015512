class Solution:
    def longestObstacleCourseAtEachPosition(self, obstacles: List[int]) -> List[int]:
        stack = []
        res = []
        for o in obstacles:
            if not stack or o >= stack[-1]:
                stack.append(o)
                res.append(len(stack))
            else:
                index = bisect.bisect(stack, o)
                stack[index] = o
                res.append(index + 1)
        return res
        
                
            