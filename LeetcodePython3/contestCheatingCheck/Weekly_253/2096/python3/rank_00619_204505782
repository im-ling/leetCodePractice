class Solution:
    def longestObstacleCourseAtEachPosition(self, obstacles: List[int]) -> List[int]:
      n = len(obstacles)
      res = []
      res.append(obstacles[0])
      ans = [0] * n
      ans[0] = 1
      for i in range(1, n):
        if obstacles[i] >= res[-1]:
          res.append(obstacles[i])
          ans[i] = len(res)
        else:
          idx = bisect_right(res, obstacles[i])  
          res[idx] = obstacles[i]
          ans[i] = idx + 1 
      return ans    