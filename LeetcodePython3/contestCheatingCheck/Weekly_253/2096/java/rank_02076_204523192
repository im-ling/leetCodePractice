class Solution {
    public int[] longestObstacleCourseAtEachPosition(int[] obstacles) {
        int[] ans = new int[obstacles.length];
        int[] LIS = new int[obstacles.length];
        int size = 0;
        int i = 0;
        for(int n : obstacles){
            int left = 0, right = size;
            while(left < right){
                int mid = (left + right)>>1;
                if(LIS[mid] <= n) left = mid+1;
                else right = mid;
            }
            LIS[left] = n;
            if(left == size) size++;
            ans[i++] = left+1;
        }
        
        return ans;
    }
}