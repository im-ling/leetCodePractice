class Solution {
public:
    vector<int> longestObstacleCourseAtEachPosition(vector<int>& obstacles) {
        int n = obstacles.size();
	vector<int> d;
	vector<int> retVal;
	for (int o : obstacles)
	{
		auto it = upper_bound(d.begin(), d.end(), o);
		if (it == d.end())
        {
			d.emplace_back(o);
            retVal.emplace_back(d.size());
        }
		else
        {
			*it = o;
            retVal.emplace_back(it - d.begin() + 1);
        }
	}
	return retVal;
    }
};