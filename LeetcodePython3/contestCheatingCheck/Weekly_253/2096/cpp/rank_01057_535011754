class Solution {
public:
    vector<int> longestObstacleCourseAtEachPosition(vector<int>& o) {
        int n=o.size();
        int dp[n],k=0;
        vector<int>res(n,0);
        for(int i=0;i<n;i++)
        {
            int x=upper_bound(dp,dp+k,o[i])-dp;
            //if(x>0 && dp[x-1]==o[i]) x--;
            if(x==k) {dp[k]=o[i];k++;}
            else dp[x]=o[i];
            res[i]=x+1;
        }
        return res;
    }
};