#define INF 1e9

class Solution {
public:
  vector<int> longestObstacleCourseAtEachPosition(vector<int>& obstacles) {
    int n = obstacles.size();
    vector<int> dp(n+1, INF);
    vector<int> ans;

    dp[0] = 0;
    for (int x : obstacles) {
      auto itr = upper_bound(dp.begin(), dp.end(), x);
      int idx = ans.emplace_back(itr - dp.begin());
      
      *itr = x;
    }

    return ans;
  }
};
