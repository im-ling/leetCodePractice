class Solution {
public:
    vector<int> longestObstacleCourseAtEachPosition(vector<int>& a) {
    int n=a.size();
    if(a.size()==1)return a;    
    vector<int>dp(n+1,INT_MAX);
        dp[0]=INT_MIN;
    vector<int>res;    
    for(int i=0;i<n;i++){
        int index=upper_bound(dp.begin(),dp.end(),a[i])-dp.begin();
        res.push_back(index);
        if(dp[index-1]<=a[i] && a[i]<dp[index]){
            dp[index]=a[i];
        }
    }
    return res;
    }
};