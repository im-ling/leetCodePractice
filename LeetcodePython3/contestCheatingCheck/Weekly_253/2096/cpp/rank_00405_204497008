#include <iostream>
#include <bits/stdc++.h>
#include <ctime>
#include <algorithm>
#include <stdlib.h>
#define x first
#define y second
using namespace::std;
using LL = long long;
using ULL = unsigned long long;
// ULL 是可以自己取模的
using PII = pair<int,int>;
const int INF = 0x3f3f3f3f;
const int MOD = 1e9 + 7;
const int dir[4][2] = {{1,0},{-1,0},{0,1},{0,-1}};
const int N = 1e5 + 7;
int n,m,a,b;
class Solution {
public:
    int dp[N];
    vector<int> longestObstacleCourseAtEachPosition(vector<int>& nums) {
        n = nums.size();
        vector<int> res(n,1);
        dp[1] = nums[0];
        int rr = 1;
        for(int i = 1;i < n;i ++) {
            int l = 0;
            int r = rr;
            while(l <= r) {
                int mid = (l + r)  / 2;
                if(dp[mid] <= nums[i]) l = mid + 1;
                else r = mid - 1;
            }
            res[i] = l;
            if(l - 1 == rr) dp[++rr] = nums[i];
            else dp[l] = nums[i];
        }
        return res;
    }
};