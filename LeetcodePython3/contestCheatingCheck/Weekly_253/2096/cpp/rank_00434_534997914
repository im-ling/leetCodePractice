class Solution {
public:
    vector<int> longestObstacleCourseAtEachPosition(vector<int>& a) {
        int n = a.size();
        vector <int> ret(n);
        vector <int> s;
        for (int i = 0; i < n; i++) {
            int j = upper_bound(s.begin(), s.end(), a[i]) - s.begin();
            if (j == s.size()) 
                s.push_back(a[i]);
            else s[j] = a[i];
            ret[i] = j + 1;
        }
        return ret;
    }
};