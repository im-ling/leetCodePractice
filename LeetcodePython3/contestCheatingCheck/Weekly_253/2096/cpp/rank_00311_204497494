const int inf = 1e8;
class Solution {
public:
    vector<int> longestObstacleCourseAtEachPosition(vector<int>& obstacles) {
        int n=obstacles.size();
        vector<int> op(n+1),dp(n);
        for(int i=0;i<=n;++i) op[i]=inf;
        for(int i=0;i<n;++i){
            int pos=upper_bound(op.begin(),op.end(),obstacles[i])-op.begin();
            op[pos]=obstacles[i];
            dp[i]=pos+1;
        }
        return dp;
    }
};